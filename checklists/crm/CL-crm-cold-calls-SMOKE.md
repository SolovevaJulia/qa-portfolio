# Чек-лист — CRM → Инструменты → Холодные звонки (SMOKE)

**Project:** CRM  
**Компонент/Модуль:** Инструменты → Холодные звонки  
**Экран/URL/Маршрут:** https://crm-test.ru
**Тестер:** Юлия  
**Дата:** 14.01.2026  
**Окружение:** **test**  
**Сборка/Версия:** **v.525bcb36**  
**Роль:** **admin**  
**ОС/Браузер/Разрешение:** **Windows 11 / Chrome (последняя) / 1920×1080**

## Предусловия
- [x] Пользователь авторизован.
- [x] Есть доступ к разделу «Инструменты → Холодные звонки».
- [x] Права для ролей (минимум): риэлтор и руководитель риэлтора имеют доступ (зафиксировать фактическое).
- [x] Интернет/доступ к crm-backend без блокировок.

## Тестовые данные
- [x] Клиент 1: обычное ФИО + телефон.  
- [x] Клиент 2: ФИО с буквой «ё».  
- [x] Клиент 3: очень длинное ФИО (для обрезки/переноса).  
- [x] Несуществующий клиент (сценарий «Нет найдено → Создать нового клиента»).  
- [x] Ссылка на объект 1: короткая (домен + 1 параметр).  
- [x] Ссылка на объект 2: очень длинная (много параметров).  
- [x] Цена: 0 / 1 / 999 / 1 000 000 / 5 600 000 / максимально допустимая (границы).  
- [x] Полезный совет: короткий / длинный (2000+ символов) / с переносами строк / с эмодзи.  
- [x] Примечание: пустое / короткое / длинное / с переносами строк.

## Навигация и доступ
- [x] Раздел «Холодные звонки» отображается в меню «Инструменты».  
- [x] Раздел открывается без ошибок (UI/консоль).  
- [x] Обновление страницы (F5) не ломает роутинг/без «белого экрана».  
- [x] Прямая ссылка на раздел открывается корректно (если предусмотрено).

## Таблица (список)
- [x] На экране есть: «фильтр-поиск», кнопка refresh, «Добавить», пагинация, «на странице».  
- [x] Таблица загружается, данные отображаются без артефактов.  
- [x] Пустое состояние (нет записей) отображается корректно.  
- [x] Длинные значения (URL/тексты) не ломают сетку (обрезка/ellipsis).  
- [x] Клик по строке открывает карточку.  
- [x] Refresh обновляет данные (видно по изменению/Network).  
- [x] После создания/редактирования запись в таблице обновляется без принудительного F5.

## Поиск (поле «фильтр-поиск»)
- [x] Поиск срабатывает по вводу (и/или Enter — зафиксировать фактическое).  
- [x] Регистр не влияет (Иван/иван).  
- [x] Работает поиск по подстроке.  
- [x] Пустая выдача показывает корректное «Не найдено/ничего не найдено».

## Сортировка и пагинация
- [ ] Сортировка по «След звонок» работает (ASC/DESC).  
- [ ] Пагинация переключает страницы корректно.  
- [ ] «На странице: N» применяется корректно.  
- [ ] Поиск + пагинация работают совместно (фильтр не сбрасывается при переходе страниц).

## Создание звонка (Добавить → Новый звонок)
- [x] Форма открывается, видны «Сохранить» и «Отменить».  
- [x] «Клиент» — обязательное поле.  
- [x] Попытка сохранить без клиента показывает понятную валидацию у поля «Клиент».  
- [x] Выбор клиента из списка сохраняется.  
- [x] В селекте клиента работает поиск (подстрока/регистр).  
- [x] «Дата/время следующего звонка» выбирается через календарь.  
- [x] Дату/время можно очистить.  
- [x] Некорректная дата/время обрабатывается корректно.  
- [x] «Ссылка на объект»:  
  - [x] принимает валидный URL;  
  - [x] длинный URL не ломает форму;  
  - [x] невалидный URL обрабатывается корректно (ошибка или как текст — зафиксировать фактическое).  
- [x] «Цена объекта»:  
  - [x] по умолчанию корректна (например, 0);  
  - [x] не принимает буквы/символы;  
  - [x] не принимает отрицательные значения;  
  - [x] большие значения не ломают поле.  
- [x] «Примечание»:  
  - [x] можно оставить пустым;  
  - [x] длинный текст + переносы сохраняются.  
- [x] «Отменить» закрывает форму и не создаёт запись.

## Создание клиента из формы звонка (если клиента не нашли)
- [x] В поиске клиента при отсутствии совпадений показывается «Не найдено».  
- [x] Кнопка «Создать нового клиента» доступна.  
- [x] Создание клиента открывается корректно.  
- [x] После создания:  
  - [x] новый клиент доступен для выбора;  
  - [x] выбранный/созданный клиент подставляется в звонок (авто или вручную — зафиксировать фактическое);  
  - [x] ранее заполненные поля звонка не теряются.

## Сохранение звонка
- [ ] «Сохранить» создаёт запись без ошибок 422/500.  
- [x] После сохранения ожидаемое действие (возврат в таблицу).  
- [x] Новая запись появляется в таблице с корректными значениями.  
- [x] «Создал/Создан» заполняются корректно.

## Карточка звонка (просмотр)
- [x] Карточка открывается из таблицы.  
- [x] Заголовок содержит номер (например, «#2 Холодный звонок»).  
- [x] Отображаются данные:  
  - [x] имя клиента;  
  - [x] телефон клиента;  
  - [x] ссылка на объект;  
  - [x] цена;  
  - [x] дата/время следующего звонка;  
  - [x] примечание;  
  - [x] «Создал»;  
  - [x] «Дата изменения».

## Редактирование звонка
- [x] Кнопка «Изменить» доступна.  
- [x] Поля предзаполнены текущими значениями.  
- [x] Можно изменить дату/время следующего звонка и сохранить.  
- [x] Можно изменить ссылку на объект и сохранить.  
- [x] Можно изменить цену и сохранить.  
- [x] Можно изменить примечание и сохранить.  
- [x] После сохранения данные обновились в карточке и таблице.  
- [x] «Дата изменения» обновилась.  
- [x] Отмена редактирования не меняет данные.

## Удаление звонка
- [x] Кнопка «Удалить» доступна.  
- [x] Есть подтверждение удаления.  
- [x] Отмена подтверждения не удаляет запись.  
- [x] Подтверждение удаляет запись.  
- [x] После удаления запись исчезает из таблицы.  
- [x] Удалённая карточка по прямой ссылке не открывается (корректное сообщение/404), без падений.

## Полезные советы (в карточке)
- [x] Блок «Полезные советы» отображается.  
- [x] Длинные советы не ломают верстку.  
- [x] «Добавить» добавляет новый совет.  
- [x] Пустой совет не сохраняется.  
- [x] Советы поддерживают переносы строк/эмодзи.  
- [x] Строка `<script>alert(1)</script>` отображается как текст и не исполняется.  
- [ ] Связь с таблицей: последний «Полезный совет» попадает в колонку.

## Логи и ошибки
- [x] В консоли нет ошибок при открытии/создании/редактировании/удалении.  
- [x] В Network нет 500/422 при корректных данных.  
- [ ] При ошибке запроса пользователь получает сообщение (не «молча ничего не происходит»).  
- [ ] При ошибке сохранения введённые данные не теряются (если предусмотрено).

## Минимум тест-дизайна (комбинации)
- [x] Создать звонок: клиент выбран, остальные поля пустые.  
- [x] Создать звонок: дата заполнена, цена = 0, ссылка пустая.  
- [x] Создать звонок: длинный URL + цена 5 600 000 + длинное примечание.  
- [x] «Не найдено» → создать клиента → создать звонок.  
- [x] Добавить 2–3 полезных совета (короткий + длинный) и проверить отображение в карточке и таблице.

## Результат проверки / Комментарии / Файлы
- Итог: Pass/Fail  
- Комментарии: см. «Итоги проверки».  

## Итоги проверки

**Сессия:** CRM → Инструменты → Холодные звонки (SMOKE)  
**Дата:** 14.01.2026  
**Сборка/Версия:** **v.539de326**  
**URL:** https://crm-test.ru

### Покрытие
- Открытие раздела и навигация.  
- Таблица: отображение колонок, данных, колонка «Полезный совет».  
- Создание звонка: выбор клиента, поиск клиента, сценарий «не найдено», валидации.  
- Фильтры: проверка фильтра по «Создан».  
- Карточка звонка: просмотр и блок «Полезные советы».  
- Сообщения об ошибках/валидации (UX/локализация).

### Найдено
- **Опечатка в названии колонки «Ссылка».**  
- **404 при создании звонка в валидационных сценариях** (невалидная ссылка, повторный клиент) — вместо понятной ошибки.  
- **Фильтр по «Создан» не работает.**  
- **Непонятные/не локализованные ошибки валидации.**  
- **Если в карточке 2+ полезных совета, в таблице не отображается ни один.**  
- **«Нет найдено» → «Не найдено».**

### Вывод
- **Status:** **Fail**  
- Риски/наблюдения:  
  - 404 в сценариях валидации/бизнес-логики — критично для UX (пользователь не понимает, что исправлять).  
  - Некорректный фильтр «Создан» мешает работе по датам.  
  - «Полезные советы» не отражаются в таблице при количестве > 1 — вводит в заблуждение.

### План ретеста (после фиксов)
1. Таблица: заголовок «Ссылка», отображение «Полезного совета» при 0/1/2+.  
2. Создание звонка:  
   - невалидный URL → корректная валидация (без 404);  
   - повторный клиент → поведение по правилам (ошибка/разрешение) без 404.  
3. Фильтр по «Создан»: разные даты/диапазоны, совместно с пагинацией.  
4. Локализация/понятность ошибок валидации на форме/карточке.  
5. Текст поиска клиента: «Не найдено».

### Ретест-лог
| Баг/Задача | Что фиксили | Версия | Результат | Примечания |
| --- | --- | --- | --- | --- |
| CRM | Опечатка «Ссылка» | v.<hash> | ☐ / ✅ |  |
| CRM | 404 при создании (невалидный URL/повторный клиент) | v.<hash> | ☐ / ✅ |  |
| CRM | Фильтр по «Создан» | v.<hash> | ☐ / ✅ |  |
| CRM | Локализация/тексты ошибок | v.<hash> | ☐ / ✅ |  |
| CRM | «Полезный совет» пустой при 2+ советах | v.<hash> | ☐ / ✅ |  |
| CRM | «Нет найдено» → «Не найдено» | v.<hash> | ☐ / ✅ |  |

### Примечания / Артефакты
- Чек-лист: ссылка из репозитория/папки.  
- Скриншоты:  
  - `image4.png` — опечатка в колонке «Ссылка».  
  - `image3.png` — 404 при создании (невалидная ссылка/повторный клиент).  
  - `image5.png` — фильтр «Создан» не работает.  
  - `image1.png` — непонятные ошибки валидации.  
  - `Снимок_экрана_2026-01-14_111658.png`, `…_111703.png` — 2+ советов → пусто в таблице.

